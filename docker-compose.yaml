version: "3.5"

volumes:
  pivx-data:
  pivx1-data:
  explorer-data:

services:
  n0:
    build: .
    command: ['sh', '-c', '/app/entrypoint.sh']
    ports:
      - "0.0.0.0:51473:51473"
      - "0.0.0.0:51472:51472"
    volumes:
      - ./entrypoint.sh:/app/entrypoint.sh
      - ./pivx-data:/app/.pivx
    restart: always

  n1:
    build: .
    command: ['sh', '-c', '/app/entrypoint.sh']
    environment:
      REMOTES: ':51472'
    ports:
      - "0.0.0.0:51473:51473"
      - "0.0.0.0:51472:51472"
    volumes:
      - ./entrypoint.sh:/app/entrypoint.sh
      - ./pivx1-data:/app/.pivx
    restart: always

  explorer:
    build: ../explorer/.
    command: ['sh', '-c', 'sleep 10 && ./blockbook -sync -blockchaincfg=./blockchaincfg.json -internal=:9030 -public=:9130 -logtostderr']
    volumes:
      - ../blockbook/build/blockchaincfg.json:/build/blockchaincfg.json
      - explorer-data:/build/data
    ports:
      - "0.0.0.0:9030:9030"
      - "0.0.0.0:80:9130"
    depends_on: 
      - n0